{% if suggestions and suggestions|length > 0 %}
<div class="modern-card overflow-hidden shadow-lg border border-gray-200 animate-fadeIn" role="listbox">
    <div class="py-1">
        {% for suggestion in suggestions %}
        <div class="suggestion-item px-4 py-3 hover:bg-blue-50 cursor-pointer transition-all duration-150 border-b border-gray-100 last:border-b-0 focus:bg-blue-50 focus:outline-none"
             tabindex="0"
             role="option"
             data-query="{{ suggestion['symbol'] }}"
             data-index="{{ loop.index0 }}"
             onclick="selectSuggestion('{{ suggestion['symbol'] }}')">
            <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <div class="w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-sm">
                                <span class="text-white font-bold text-sm">{{ suggestion['symbol'][:2] if suggestion['symbol'] else 'ST' }}</span>
                            </div>
                        </div>
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-bold text-gray-900 truncate">
                                {{ suggestion['symbol'] }}
                            </p>
                            <p class="text-xs text-gray-600 truncate">
                                {{ suggestion['name'][:60] if suggestion['name'] else '' }}{% if suggestion['name'] and suggestion['name']|length > 60 %}...{% endif %}
                            </p>
                        </div>
                    </div>
                </div>
                <div class="flex-shrink-0 ml-4 text-right">
                    {% if suggestion['price'] %}
                    <p class="text-sm font-semibold text-gray-900">
                        {% if suggestion['currency'] == 'EUR' %}€{% elif suggestion['currency'] == 'GBP' %}£{% elif suggestion['currency'] == 'USD' %}${% endif %}{{ "%.2f"|format(suggestion['price']) }}
                    </p>
                    {% else %}
                    <p class="text-sm font-semibold text-gray-400">N/A</p>
                    {% endif %}
                    <p class="text-xs text-gray-500 uppercase font-medium">
                        {{ suggestion['exchange'] if suggestion['exchange'] else 'Exchange' }}
                    </p>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="px-4 py-2 bg-gradient-to-r from-gray-50 to-blue-50 border-t border-gray-200">
        <p class="text-xs text-gray-600 text-center">
            <kbd class="px-2 py-1 bg-white border border-gray-300 rounded shadow-sm text-xs font-semibold">↑</kbd> 
            <kbd class="px-2 py-1 bg-white border border-gray-300 rounded shadow-sm text-xs font-semibold">↓</kbd> 
            to navigate • <kbd class="px-2 py-1 bg-white border border-gray-300 rounded shadow-sm text-xs font-semibold">Enter</kbd> to select • <kbd class="px-2 py-1 bg-white border border-gray-300 rounded shadow-sm text-xs font-semibold">Esc</kbd> to close
        </p>
    </div>
</div>

<script>
// Attach selectSuggestion function to window for onclick access
window.selectSuggestion = function(symbol) {
    const queryInput = document.getElementById('query');
    queryInput.value = symbol;
    document.getElementById('suggestions').innerHTML = '';
    document.querySelector('#search-form').dispatchEvent(new Event('submit', {bubbles: true, cancelable: true}));
};

// Initialize suggestion navigation when suggestions load
(function() {
    const suggestions = document.querySelectorAll('.suggestion-item');
    window.totalSuggestions = suggestions.length;
    window.selectedSuggestionIndex = -1;
    
    // Auto-highlight first suggestion
    if (suggestions.length > 0) {
        window.selectedSuggestionIndex = 0;
        suggestions[0].classList.add('bg-blue-50');
    }
})();
</script>

<style>
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.animate-fadeIn {
    animation: fadeIn 0.2s ease-out;
}

.suggestion-item:hover,
.suggestion-item.selected {
    background-color: #eff6ff;
}
</style>
{% endif %}
